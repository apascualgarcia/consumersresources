\documentclass[12pt, titlepage]{report}
\usepackage{consumer_resource_final}
\graphicspath{{./figures/}}

\begin{document}
% Structure of this:
% - Results of the project:
%   - LRI scenario:
%     - Found a regime where dynamical stability is ensured!
%     - However, hard to know when such a regime could be attained so designed an algorithmic procedure to find regimes as close to this as possible
%     - The outcome of that was an improvement of dynamical stability compared to a fully connected syntrophy matrix but only for matrices at low connectance (probably because Rc grows fast with the connectance so definitely harder for the inequality to be fulfilled)
%     - The next step would be to try with other, less heuristic forms of energy, eg some that take into account how Rc changes with A (since we neglected this)
The first significant result of this Thesis was the derivation of the equations that describe the metaparameters space domain in which feasibility is insured. This allowed us to accurately predict how syntrophy affects feasibility of microbial communities and told us the relevant zone of metaparameters (Methods \ref{sec : methods feasibility volume}), which prevented us from dealing with unfeasible systems.
We then discovered a special regime of parameters, named ``strong LRI regime'' (Methods \ref{sec : strong LRI regime methods}), which we proved is dynamically stable. This led to the development of the MCMC ``LRI'' algorithm explained in Methods \ref{section: methods LRI MC solver} which goal is, for a given set of metaparameters and a consumption matrix, to generate the syntrophy matrix that brings microbial communities as close as possible to the strong LRI regime. Typically the syntrophy matrices obtained through that algorithmic procedure are very nested, such that the species which eat few resources end up releasing a lot of them and vice-versa. However, computations in Methods \ref{sec: dynamical stability methods fully dynamically stable region} showed that the goal behind the LRI algorithm is only partially achieved: microbial communities in the LRI syntrophic scenario can bear a larger syntrophic interaction while remaining dynamically stable -- compared to the ``null case'' of a fully connected syntrophy matrix -- but only if the average number of resources eaten by each consumer is low. Why the LRI scenario is inefficient at high consumption matrix connectance is as of now largely unknown. It could be due to feasibility considerations. It is indeed still unclear in which conditions the strong LRI regime is feasible, and it may happen that when the connectance of the consumption matrix is too large, such a regime simply cannot exist\footnote{More specifically, the critical radius $R_C$ strongly depends on the shape of the consumption matrix and gets larger as its connectance increases. It is possible that beyond a certain connectance, $R_C$ gets too large and the inequality of Theorem \ref{theorem: strong LRI regime} cannot be fulfilled anymore.}. It could also come from the choice of the energy function used in the MCMC LRI algorithm. That energy was indeed obtained in a heuristic way that neglected some factors, especially the role of the critical radius and its dependency on the shape of the syntrophy matrix, and could be bettered in a future work.

%   - Microbial communities where number of resources=number of consumers and syntrophy matrix is fully connected?:
We subsequently focused our attention on studying fairly large communities comprised of twenty-five microbial species and the same number of resources.
%     - feasibility:
%       - found a limit: contrarily to simpler models, feasibility restricts your possible metaparameters -> lose the liberty of choosing which makes the study harder
%       - the most feasible points (ie where we expect real microbial communities to exist) have high consumption rates and low equilibrium abundances -> flaw of the model here : by extrapolating results feasibility should be larger for S0->0 which is not realistic: need an upperbound for S0 or g0! (can argue that g0 cannot take any value and is somehow bounded by other biological conditions independent of the model (g0 should be determined through the help of another model cite papers that could help))
%       - systems where consumption matrix is more connected and less nested are the ones that can most support syntrophy
As predicted analytically, it was confirmed numerically that imposing the fulfillment of simple physical conditions restricts quite much the range of possible metaparameters: not all configurations have an equal chance of existing. Indeed in the absence of syntrophy (Results \ref{sec : feasibility without syntrophy}) we observe for all consumption networks a trade-off between average consumption rate and abundance of consumers in the sense that the overall proportion of resources consumed by the microbial species is bounded: there are no regimes where {a lot of microbes} eat very aggressively. If we want to increase the consumption rate beyond a certain threshold, the abundance of consumers has to be reduced, and the other way around. Adding a syntrophic mean-field interaction\footnote{That is a fully connected $A$ matrix (FC scenario).} breaks the symmetry of that trade-off: whatever the shape of the consumption network, as syntrophy increases only communities where lowly abundant microbial species aggressively consume their resources can exist\textbf{TO DO : check if there is any literature on this}. Moreover, communities where the average number of resources eaten by a consumer is large, under the caveat that there should be a small consumption overlap, are the ones which existence is least impacted by syntrophy\textbf{TO DO: check if there is literature saying that LV systems are less feasible when nestedness is high, rephrase this better if possible}.

%     - dynamical stability:
%       - follows the same trend as feasibility: systems with high g0 and low S0 are more dynamically stable than others, however we did not find any pattern in which feasibility -> dynamical stability
%       - we found that feasibility and dynamical stability ``have the same trend'' by which we mean systems that are most feasible are most dynamically stable: these again have a large gamma0 and a small S0
%       - at the same syntrophy: the points with S0 as large as possible (ie where S0 ~ g0 are{-1}) are the most dynamically stable (dynamical stability largest at the boundary of the feasible volume)
%       - interesting effect of syntrophy: as syntrophy increases, dynamical stability is improved (main eigenvalue has a larger magnitude (but still is negative)), but on fewer points: gives a ``fine tuning effect''
%       - systems where consumption matrix is more connected and less nested are the ones that can most support syntrophy and remain dynamically stable.

Whereas the feasibility region offered a fairly simple topology -- the metaparameters space was made of two very clear regions of either complete feasibility or complete unfeasibility separated by a narrow area of mixed feasibility -- the dynamical stability region presented a fractured landscape made of many almost dynamically stable points.
%Because it was required from a metaparameters set that it be fully feasible in order to determine its probability of being dynamically stable, we unsurpisingly observed a shrinkage of the dynamical stability region as syntrophy is increased.
Surprisingly enough, a similar trend as feasibility was observed: irrespective of the topology of the consumption matrix, microbial communities which have at equilibrium only a scarce abundance of consumers which eat their resources aggressively are the least impacted by syntrophy in terms of their dynamical stability. In general, as for the case of feasibility, microbial communities with highly connected consumption matrices with few syntrophic overlap are the ones which dynamical stability region is least impacted by the addition of a syntrophic interaction. However the same tendency being observed does not signify that all points of the metaparameters space which are feasible also are dynamically stable. On the contrary, for no consumption-syntrophy network did we find that feasibility implied dynamical stability for \important{all points} of the metaparameters space. A detailed study of exactly which sectors of the metaparameters space give rise to feasible communities that are always dynamically stable remains to be conducted. Among the points which we know are dynamically stable we were able to determine analytically (and that was confirmed by simulations) that the points at the upper border of the dynamical stability region are the most dynamically stable -- in the sense that they take the least time to recover from perturbations of their abundances. Another trade-off worth mentioning is the one between size of dynamical stability region and ``the speed of recovery'' following perturbations. Indeed as syntrophy is increased, the size of the dynamically stable region shrinks\footnote{Among others, because of the feasibility requirements.} but the average largest real part of the spectrum of the jacobians observed within the dynamically stable region\textbf{TO DO : see exactly how that max is computed} increases. In short when the syntrophic interaction is raised, there are fewer dynamically stable points, but their stability also grows. This means we expect microbial communities where a large syntrophic interaction is observed to be fairly fine-tuned.

%     - structural stability:
%       - placed ourselves at the most dynamically stable points for all
%       - defined the critical dynamical syntrophy at that point as the largest syntrophy for which we have full dynamical stability AT THAT POINT. (how does the dynamical critical syntrophy change? tells what structure for your syntrophy matrix)
%       - study environmental perturbations in these conditions: in the absence of syntrophy, systems with a consumption matrix less nested and more connected can survive larger environmental perturbations
%       - how does having syntrophy impact the system? it does not impact noticeably (maybe too much of a fine tuning effect) except if the structure is NIS -> comparing this with the other regimes, suggests you should release to as many people as you can but most importantly NOT TO YOU
%       - interesting trade-off between structural stability and dynamical stability in the structure of the syntrophy matrix : if you want to be more structurally stable should be NIS but if you want to be more dynamically stable should be RS
The study of structural stability, aka the impact of environmental perturbations, formed the final part of this Thesis. Because of reasons explained in the text, we decided to move to a system where the number of resources are doubled and the number of consumers is fixed. We chose a highly dynamically stable point of the metaparameters space and started by computing the critical dynamical syntrophy -- the largest syntrophy such that we observe dynamically stable parameters with a probability of one -- of each consumption-syntrophy network. In conformity with the trend hithertho observed, consumption matrices with a large connectance and a small ecological overlap can achieve the largest critical dynamical syntrophy. We then compared how microbial communities react to environmental perturbations in three different cases: as a null case, without syntrophy, then at their own critical dynamical syntrophy and as a ``fairer'' point of comparison, at the minimal critical dynamical syntrophy (\ie the largest syntrophic interaction which can be sustained by all the matrices we considered). In all cases, we observed that, as for dynamical stability, the communities with a highly connected consumption matrix with little ecological overlap can recover from the largest environmental perturbations, which allows us to draw the conclusion that as regard to the shape of the consumption matrix dynamical and structural stability go hand in hand. Moreover, we were surprised to observe that -- except for one specific scenario -- syntrophy does not significantly impact structural stability of microbial communities, whether it was at the critical dynamical syntrophy of each network or at the minimal critical dynamical syntrophy. The only scenario where adding a syntrophic interaction undoubtedly increased structural stability was if the syntrophy was at its largest possible value (critical dynamical syntrophy) and the topology of the syntrophy matrix is such that consumers release every resource except the ones they do not eat. That result is very surprising to us because we observed that a random structure of the syntrophy matrix allowed a larger critical dynamical syntrophy, \ie a larger syntrophic interaction without a loss of dynamical stability. That fact hints at a trade-off between dynamical and structural stability in terms of the shape of the syntrophy network that deserves to be explored in future studies \textbf{TO DO: to be sure of this should measure largest eigenvalue at that specific point for the different scenarios}.

%   - what is the effect of changing the structure of A?
%       - check for feasibility
%       - for dynamical stability: RS provides a better way to survive syntrophy, LRI also changes but only for low connectance consumption matrix
%       - for structural stability: no significant difference again except in the NIS case and at own critical dynamical syntrophy
So the shape of the syntrophy matrix has an effect on the structural stability of the system but it also affects feasibility and dynamical stability. While it surprisingly does not affect much the shape of the fully feasible region, it changes each consumption network's feasibility in a non trivial way. Overall we do not observe any significant increase of feasibility\footnote{By ``increase of feasibility'' we mean ``decrease of the feasibility decay rate''.} for the NIS regime compared to the FC case, except for one particular lowly connected and lowly nested consumption matrix and highly connected highly nested consumption matrices. On the other hand, the LRI scenario greatly improves feasibility for lowly connected consumption networks but does not provide any significant change at high connectance. Finally, a random structure of the syntrohy matrix (RS regime) consistently improves feasibility, the lower the connectance of the consumption matrix, the larger the improvement. The same remarks hold for dynamical stability. The common ground between these cases is that the syntrophy matrix is lowly connected. Even though the reasons behind that behaviour remain unclear this hints that syntrophy matrices with a lower connectance enable a larger tolerance towards the addition of a syntrophic interaction.

%   - what is the effect of changing the number of resources?
%       - check this precisely but should be:
%       - feasibility : restricts common feasible volume (is it because of patchiness? should be investigated)
%       - dynamical stability : does improve the stability by lowering eigenvalue? and removes patchiness -> easier to work with.

All the previous conclusions are drawn for a system where the number of consumers is equal to the number of resources. There is however little reason that such systems should be prevalent in nature -- and in fact they are not \textbf{TO DO: insert ref for this} -- which begs the question of the consequences of changing \eg the number of resources while keeping the number of consumers fixed. We roughly investigated what happens when the number resources goes from twenty-five to fifty. Interestingly enough, this reduces the common fully feasible region such that the largest syntrophy that \important{all} consumption-syntrophy can attain is lessened. However we also observed that doubling the number of resources does not -- on average -- significantly change the feasibility decay rate of each matrix. These contrasting conclusions, which may be due to a change of the profile of the feasibility function across the consumption rate-consumers abundance, need more investigation\textbf{TO DO: check maybe an error in the code}. As for the case of dynamical stability, interestingly enough adding more resources smoothes out the fully dynamically stable region, which eliminates most of the almost dynamically stable points and in turn allows for a common fully dynamically stable region at syntrophies larger than zero. Although the dynamical stability decay rate is on average left unchanged, there are hints that stability is increased (\ie the largest real part of the spectrum is increased) when the number of resources is augmented, which is in accordance with the classical ecology literature \textbf{TO DO : cite here}. In any case, the effect of the number of resources of a microbial community remains an interesting open topic.
% - What could be improved:
%   - definitely the LRI regime deserves more introspection: first of all study exactly in what conditions it can happen (this wasn't done thoroughly) and find a better expression for the energy

Although some progress on the subject of the impact of syntrophy on microbial communities was made with this Thesis, many aspects of the problem remain obscure. The first next step is of course to confront the results we obtained with experimental data \textbf{TO DO : put ref here?}.
For instance, multiple considerations explained above lead us to expect that syntrophic microbial communities in Nature should have a low abundance of consumers at equilibrium (compared to the abundance of resources) which consume their resources at a high rate, with a very connected consumption network with little ecological overlap: how well is that prediction matched with experiments? Also if that is accurate, could microbial models explain the same results through for example an evolutionary model which would allow to bring a more biological hindsight? On the opposite, if our predictions are not matched with experiments, how can we change the model to make it more accurate?

Apart from confrontation with data, future theoretical studies still have significant work to do. For instance, a more exhaustive study of how structural stability changes as a function of the consumption rate and the abundance of consumers would surely provide interesting results: are there zones of the metaparameters space that are much sensible to perturbations of the consumers and the resources but not to environmental changes? Are there regimes that can sustain any perturbation at any intensity?
However, in our opinion future works in the microbial ecology field should put their focus on finding the exact order parameter of the syntrophy matrix topology that drives the stability of this model.\textbf{TO DO : rephrase this: a bit rough as a final sentence}  

% - What should be done in the future:
%   - more exhaustive study of structural stability, how does it change as a function of consumption rate and consumers equilibrium?
%   - produce a more thorough study of the influence of the structure of the syntrophy matrix on all quantities: would allow for a fairer comparison (indeed we only considered ``scenarios'')
%   - confront the results with data
%

\end{document}
